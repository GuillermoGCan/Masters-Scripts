"0","#Problema 2.4"
"0","# Colapso de Civilizacioes"
"0",""
"0","#Paso 1: cargar la libreria ""deSolve"" empleando la funcion library()"
"0"," library(""deSolve"")"
"0",""
"0","#Considera a los parametros como variables exogenas que no pueden ser modificadas"
"0",""
"0"," parameters2.4.0 <- # Caso Base"
"0","   c(consumed.food.per.person = 400, #[kg/(person * year)]"
"0","     emigration.ratio = 5/100, #[%]"
"0","     x = 1.84"
"0","     )"
"0"," "
"0","parameters2.4.1 <- # Escenario 1: Cambio márginal en los parámetros - Consumo de alimento por persona"
"0","   c(consumed.food.per.person = 360, #[kg/(person * year)]"
"0","     emigration.ratio = 5/100, #[%]"
"0","     x = 1.84"
"0","     )"
"0",""
"0","parameters2.4.2 <- # Escenario 2: Cambio márginal en los parámetros - Cambio de razón de migración"
"0","   c(consumed.food.per.person = 400, #[kg/(person * year)]"
"0","     emigration.ratio = 5.5/100, #[%]"
"0","     x = 1.84"
"0","     )"
"0",""
"0","Colapso.De.Civilizaciones2.4.3 <- function(t, state, parameters) { # Escenario 3: Cambio estructural - Deforestación ilimitada"
"0","  with(as.list(c(state,parameters)), {"
"0","    "
"0","#auxiliary variables"
"0","    intensity <- approx( #[year]"
"0","      c(-1000,-500,0,500,800,1000),"
"0","      c(1,0.9,0.85,0.8,0.775,0.75),"
"0","      xout = t)$y"
"0","    "
"0","    food.produced <- #[kg/year]"
"0","      fertility.of.agricultural.land * "
"0","      agricultural.land "
"0","    "
"0","    demand.of.food <- #[kg/year]"
"0","      population * "
"0","      consumed.food.per.person "
"0","    "
"0","    gap <- #[kg/year]"
"0","      demand.of.food - "
"0","      food.produced "
"0","    "
"0","    number.of.people.without.food <- #[people/year]"
"0","      gap/"
"0","      consumed.food.per.person "
"0",""
"0","#flow variables"
"0","    deforestation <- #[km2/year]"
"0","      gap/max(fertility.of.agricultural.land,1)/"
"0","      intensity"
"0","    "
"0","    fertility.losses <- #[kg/(km2*year)/year]"
"0","      fertility.of.agricultural.land * "
"0","      min(2,(agricultural.land/forest)^x)/"
"0","      intensity "
"0","      "
"0","    net.natural.population.increase <- #[people/year]"
"0","      population * "
"0","      (exp(log(2)/408)-1) "
"0","    "
"0","    emigration <- #[people/year]"
"0","      emigration.ratio * "
"0","      number.of.people.without.food "
"0","      "
"0","#state variables"
"0","    dfertility.of.agricultural.land <- #[kg/(km2*year)]"
"0","      -fertility.losses "
"0","      "
"0","    dforest <- #[km2/year]"
"0","      ifelse(forest-deforestation <=1,"
"0","             0,"
"0","             -deforestation)"
"0","    "
"0","    dagricultural.land <- #[km2/year]"
"0","      ifelse(forest-deforestation <=1,"
"0","             0,"
"0","             deforestation)"
"0","    "
"0","    dpopulation <- #[people/year]"
"0","      ifelse(population + net.natural.population.increase - emigration <= 0,"
"0","             -population,"
"0","             net.natural.population.increase - "
"0","      emigration)"
"0","    "
"0","    list(c(dfertility.of.agricultural.land,"
"0","             dagricultural.land,"
"0","             dforest,"
"0","             dpopulation),"
"0","         intensity = intensity,"
"0","         dpopulation = dpopulation)"
"0",""
"0","  })"
"0","}"
"0"," "
"0","# Resultados"
"0",""
"0","## Caso Base"
"0",""
"0","out2.4.0 <- ode(y = InitialConditions2,"
"0","           times = times2,"
"0","           func = Colapso.De.Civilizaciones2.3,"
"0","           parms = parameters2.4.0,"
"0","           method =intg.method)"
"0",""
"0","out2.4.0df <- data.frame(out2.4.0)"
"0",""
"0","### Graficas solo variables de interés"
"0","plot(out2.4.0, which = c(""population"","
"0","                       ""fertility.of.agricultural.land"","
"0","                       ""forest"","
"0","                       ""agricultural.land"""
"0","                       ),"
"0","     xlab = ""years"","
"0","     ylab = c(""Population [people]"","
"0","                       ""Fertility of Agricultural Land [kg/km2]"","
"0","                       ""Forest [km2]"","
"0","                       ""Agricultural Land [km2]"""
"0","              )"
"0","     )"
