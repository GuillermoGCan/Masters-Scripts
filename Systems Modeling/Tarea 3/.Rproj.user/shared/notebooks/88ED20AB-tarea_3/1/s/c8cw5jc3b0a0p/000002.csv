"0","#Problema 2.5"
"0","# Colapso de Civilizacioes"
"0",""
"0","#Paso 1: cargar la libreria ""deSolve"" empleando la funcion library()"
"0"," library(""deSolve"")"
"0",""
"0","#Considera a los parametros como variables exogenas que no pueden ser modificadas"
"0",""
"0"," parameters2.5<-c(consumed.food.per.person = 400, #[kg/(person * year)]"
"0","               emigration.ratio = 5/100, #[%]"
"0","               x = 1.84,"
"0","               max.percentaje.of.hungry.population = 2.5/100 #[%]"
"0","               )"
"0"," "
"0"," #para definir tus condiciones iniciales utiiza tus variables de estado"
"0"," InitialConditions2 <- c(fertility.of.agricultural.land = 5000000, #[kg/(km2 * year)]"
"0","                        agricultural.land = 8, #[km2]"
"0","                        forest = 5000, #[km2]"
"0","                        population = 100000 #[people]"
"0","                        ) "
"0",""
"0"," times2 <- seq(-1000, #tiempo inicial [years]"
"0","              1000, #tiempo final [years]"
"0","              1)# número de repetición de puntos [years]"
"0",""
"0","# Definimos método de integración"
"0"," intg.method<-c(""rk4"")"
"0"," "
"0","#Especificamos modelo"
"0","Colapso.De.Civilizaciones2.5 <- function(t, state, parameters) {"
"0","  with(as.list(c(state,parameters)), {"
"0","    "
"0","#auxiliary variables"
"0","    intensity <- approx( #[year]"
"0","      c(-1000,-500,0,500,800,1000),"
"0","      c(1,0.9,0.85,0.8,0.775,0.75),"
"0","      xout = t)$y"
"0","    "
"0","    food.produced <- #[kg/year]"
"0","      fertility.of.agricultural.land * "
"0","      agricultural.land "
"0","    "
"0","    demand.of.food <- #[kg/year]"
"0","      population * "
"0","      consumed.food.per.person "
"0","    "
"0","    gap <- #[kg/year]"
"0","      demand.of.food - "
"0","      food.produced "
"0","    "
"0","    number.of.people.without.food <- #[people/year]"
"0","      gap/"
"0","      consumed.food.per.person "
"0",""
"0","#flow variables"
"0","    deforestation <- #[km2/year]"
"0","      min(gap/max(fertility.of.agricultural.land,1),forest/4)/"
"0","      intensity "
"0","    "
"0","    fertility.losses <- #[kg/(km2*year)/year]"
"0","      fertility.of.agricultural.land * "
"0","      min(2,(agricultural.land/forest)^x)/"
"0","      intensity "
"0","      "
"0","    net.natural.population.increase <- #[people/year]"
"0","      population * "
"0","      (exp(log(2)/408)-1) "
"0","    "
"0","    emigration <- #[people/year]"
"0","      emigration.ratio * "
"0","      number.of.people.without.food "
"0","      "
"0","#state variables"
"0","    dfertility.of.agricultural.land <- #[kg/(km2*year)]"
"0","      -fertility.losses "
"0","      "
"0","    dforest <- #[km2/year]"
"0","      ifelse(number.of.people.without.food <= max.percentaje.of.hungry.population * population,"
"0","             0,"
"0","             -deforestation)"
"0","       "
"0","    dagricultural.land <- #[km2/year]"
"0","      ifelse(number.of.people.without.food <= max.percentaje.of.hungry.population * population,"
"0","             0,"
"0","             deforestation) "
"0","    "
"0","    dpopulation <- #[people/year]"
"0","      net.natural.population.increase - "
"0","      emigration "
"0","    "
"0","    list(c(dfertility.of.agricultural.land,"
"0","             dagricultural.land,"
"0","             dforest,"
"0","             dpopulation),"
"0","         dfertility.of.agricultural.land = dfertility.of.agricultural.land,"
"0","         dagricultural.land = dagricultural.land,"
"0","         dforest = dforest,"
"0","         dpopulation = dpopulation,"
"0","         number.of.people.without.food = number.of.people.without.food,"
"0","         suma = forest + agricultural.land"
"0","         )"
"0",""
"0","  })"
"0","}"
"0",""
"0","out2.5 <- ode(y = InitialConditions2,"
"0","           times = times2,"
"0","           func = Colapso.De.Civilizaciones2.5,"
"0","           parms = parameters2.5,"
"0","           method =intg.method)"
"0",""
"0","out2.5df <- data.frame(out2.5)"
"0","plot(out2.5, which = c(""number.of.people.without.food""),"
"0","     xlab = ""years"","
"0","     ylab = c(""Number Of People Without Food [people/year]"")"
"0","     )"
