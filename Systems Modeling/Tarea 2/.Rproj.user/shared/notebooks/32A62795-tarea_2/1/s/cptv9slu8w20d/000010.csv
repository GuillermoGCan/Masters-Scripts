"0","#Problema 3"
"0","#Administración de Cadena de Suministro"
"0",""
"0","#Paso 1: cargar la libreria ""deSolve"" empleando la funcion library()"
"0"," library(""deSolve"")"
"0",""
"0","#Considera a los parametros como variables exogenas que no pueden ser modificadas"
"0"," parameters<-c(assembler.sales = 150 ,#[cars/month]"
"0","               assembler.time.to.correct.inventory = 8 , #[months]"
"0","               assembler.inventory.coverage = 3, # [months]"
"0","               assembler.time.to.adjust.workforce = 10,  #[months]"
"0","               assembler.productivity = 1, #[cars/(person.month)]"
"0","               tier1.time.to.correct.inventory = 8 , #[months]"
"0","               tier1.inventory.coverage = 3, # [months]"
"0","               tier1.time.to.adjust.workforce = 10,  #[months]"
"0","               tier1.productivity = 1, #[cars/(person.month)]"
"0","               tier2.time.to.correct.inventory = 8 , #[months]"
"0","               tier2.inventory.coverage = 3, # [months]"
"0","               tier2.time.to.adjust.workforce = 10,  #[months]"
"0","               tier2.productivity = 1 #[cars/(person.month)]"
"0","               )"
"0"," "
"0"," #para definir tus condiciones iniciales utiiza tus variables de estado"
"0"," InitialConditions <- c( assembler.inventory = 300, #[cars]"
"0","                         assembler.workforce = 100, #[people]"
"0","                         tier1.inventory = 300, #[cars]"
"0","                         tier1.workforce = 100, #[people]"
"0","                         tier2.inventory = 300, #[cars]"
"0","                         tier2.workforce = 100 #[people]"
"0","                         )"
"0",""
"0"," times <- seq(0, #tiempo inicial"
"0","              100, #tiempo final #[months]"
"0","              0.1 )#número de repetición de puntos #[months]"
"0",""
"0","# Definimos método de integración"
"0"," intg.method<-c(""rk4"")"
"0",""
"0","#Especificamos modelo"
"0","Supply.Chain<- function(t, state, parameters) {"
"0","  with(as.list(c(state,parameters)), {"
"0","    "
"0","#assembler auxiliary variables"
"0","    assembler.target.inventory <- assembler.sales*assembler.inventory.coverage #[cars]"
"0","    assembler.inventory.correction <- (assembler.target.inventory-assembler.inventory)/assembler.time.to.correct.inventory #[cars/month]"
"0","    assembler.target.production <- assembler.sales + assembler.inventory.correction #[cars/month]"
"0","    assembler.target.workforce <- assembler.target.production/assembler.productivity #[people]"
"0","    "
"0","#assembler flow variables"
"0","    assembler.production <- assembler.productivity * assembler.workforce #[cars/month]"
"0","    assembler.net.hire.rate <- (assembler.target.workforce - assembler.workforce)/"
"0","      assembler.time.to.adjust.workforce #[people/month]"
"0","    "
"0","#assembler state variables"
"0","    dassembler.inventory <- assembler.production - assembler.sales #[cars/month]"
"0","    dassembler.workforce <- assembler.net.hire.rate #[people/month]"
"0","    "
"0","#tier 1 sales"
"0","    tier1.sales <- assembler.production #[cars/month]"
"0","    "
"0","#tier 1 auxiliary variables"
"0","    tier1.target.inventory <- tier1.sales*tier1.inventory.coverage #[cars]"
"0","    tier1.inventory.correction <- "
"0","      (tier1.target.inventory-tier1.inventory)/tier1.time.to.correct.inventory #[cars/month]"
"0","    tier1.target.production <- tier1.sales + tier1.inventory.correction #[cars/month]"
"0","    tier1.target.workforce <- tier1.target.production/tier1.productivity #[people]"
"0",""
"0","#tier 1 flow variables"
"0","    tier1.production <- tier1.productivity * tier1.workforce #[cars/month]"
"0","    tier1.net.hire.rate <- (tier1.target.workforce - tier1.workforce)/"
"0","      tier1.time.to.adjust.workforce #[people/month]"
"0",""
"0","#tier 1 state variables"
"0","    dtier1.inventory <- tier1.production - tier1.sales #[cars/month]"
"0","    dtier1.workforce <- tier1.net.hire.rate #[people/month]"
"0","    "
"0","#tier 2 sales"
"0","    tier2.sales <- tier1.production #[cars/month]"
"0","    "
"0","#tier 2 auxiliary variables"
"0","    tier2.target.inventory <- tier2.sales*tier2.inventory.coverage #[cars]"
"0","    tier2.inventory.correction <- "
"0","      (tier2.target.inventory-tier2.inventory)/tier2.time.to.correct.inventory #[cars/month]"
"0","    tier2.target.production <- tier2.sales + tier2.inventory.correction #[cars/month]"
"0","    tier2.target.workforce <- tier2.target.production/tier2.productivity #[people]"
"0",""
"0","#tier 2 flow variables"
"0","    tier2.production <- tier2.productivity * tier2.workforce #[cars/month]"
"0","    tier2.net.hire.rate <- (tier2.target.workforce - tier2.workforce)/"
"0","      tier2.time.to.adjust.workforce #[people/month]"
"0",""
"0","#tier 2 state variables"
"0","    #dtier2.inventory <- tier2.production - tier2.sales #[cars/month]"
"0","    #dtier2.workforce <- tier2.net.hire.rate #[people/month]"
"0","    "
"0","    dtier2.inventory <- max(c(tier2.production-tier1.production,-1*(tier2.inventory))) #[cars/month]"
"0","    dtier2.workforce <- max(c(tier2.net.hire.rate,-1*(tier2.workforce))) #[people/month]"
"0","    "
"0","    list(c(dassembler.inventory,dassembler.workforce,"
"0","           dtier1.inventory,dtier1.workforce,"
"0","           dtier2.inventory,dtier2.workforce),"
"0","         assembler.sales=assembler.sales,"
"0","         tier1.sales=tier1.sales,"
"0","         tier2.sales=tier2.sales)"
"0",""
"0","  })"
"0","}"
"0",""
"0","out <- ode(y = InitialConditions,"
"0","           times = times,"
"0","           func = Supply.Chain,"
"0","           parms = parameters,"
"0","           method =intg.method)"
"0",""
"0","#Graficas solo variables de interés"
"0","plot(out, which=c(""assembler.sales"", ""assembler.inventory"", ""assembler.workforce"","
"0","                  ""tier1.sales"", ""tier1.inventory"", ""tier1.workforce"","
"0","                  ""tier2.sales"", ""tier2.inventory"", ""tier2.workforce""),"
"0","     xlab = ""months"","
"0","     ylab =c(""assembler.sales"", ""assembler.inventory"", ""assembler.workforce"","
"0","                  ""tier1.sales"", ""tier1.inventory"", ""tier1.workforce"","
"0","                  ""tier2.sales"", ""tier2.inventory"", ""tier2.workforce""))"
"0",""
